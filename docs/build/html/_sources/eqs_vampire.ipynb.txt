{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "80fed5da",
   "metadata": {},
   "source": [
    "# VAMPIRE"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "902b14b6",
   "metadata": {},
   "source": [
    "## Auto-Correlation"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5467325e",
   "metadata": {},
   "source": [
    "### Z-Gradient  \n",
    "\n",
    "1. SHG  \n",
    "\n",
    "    $\\frac{dS_{mk}}{dE_n^*} = 0$  \n",
    "\n",
    "    $\\frac{dS_{mk}}{dE_n} = D_{kn}\\left(A_{mk}+A_{mk}'+E_k\\cdot e^{-i\\tau_m\\omega_n}\\cdot(e^{-i\\tau_0\\omega_n} + e^{i\\phi_n})\\right)$\n",
    "\n",
    "<br>\n",
    "\n",
    "2. THG  \n",
    "\n",
    "    $\\frac{dS_{mk}}{dE_n^*} = 0$  \n",
    "\n",
    "    $\\frac{dS_{mk}}{dE_n} = D_{kn}(A_{mk}+A_{mk}')\\cdot\\left(A_{mk}+A_{mk}'+2E_k\\cdot e^{-i\\tau_m\\omega_n}\\cdot(e^{-i\\tau_0\\omega_n} + e^{i\\phi_n})\\right)$\n",
    "\n",
    "<br>\n",
    "\n",
    "3. PG  \n",
    "\n",
    "    $\\frac{dS_{mk}}{dE_n^*} = D_{nk}E_k(A_{mk}+A_{mk}')\\cdot e^{i\\tau_m\\omega_n}(e^{i\\tau_0\\omega_n}+e^{-i\\phi_n})$\n",
    "\n",
    "    $\\frac{dS_{mk}}{dE_n} = D_{kn}(A_{mk}+A_{mk}')^*\\cdot\\left(A_{mk}+A_{mk}'+E_k e^{-i\\tau_m\\omega_n}(e^{-i\\tau_0\\omega_n}+e^{i\\phi_n})\\right)$\n",
    "\n",
    "<br>\n",
    "\n",
    "4. SD  \n",
    "\n",
    "    $\\frac{dS_{mk}}{dE_n^*} = 2 D_{nk}E_k (A_{mk}+A_{mk}')^*\\cdot e^{i\\tau_m\\omega_n}(e^{i\\tau_0\\omega_n}+e^{-i\\phi_n})$\n",
    "\n",
    "    $\\frac{dS_{mk}}{dE_n} = D_{kn}\\left((A_{mk}+A_{mk}')^*\\right)^2$\n",
    "\n",
    "<br>\n",
    "\n",
    "5. nth-HG  \n",
    "\n",
    "    $\\frac{dS_{mk}}{dE_n^*} = 0$  \n",
    "\n",
    "    $\\frac{dS_{mk}}{dE_n} = D_{kn}(A_{mk}+A_{mk}')^{n-2}\\cdot\\left(A_{mk}+A_{mk}'+(n-1)E_k\\cdot e^{-i\\tau_m\\omega_n}\\cdot(e^{-i\\tau_0\\omega_n} + e^{i\\phi_n})\\right)$"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "450cf25e",
   "metadata": {},
   "source": [
    "### Z-Pseudo-Hessian  \n",
    "\n",
    "1. SHG  \n",
    "\n",
    "    $V_{zz}=0$\n",
    "    \n",
    "<br>\n",
    "\n",
    "2. THG  \n",
    "\n",
    "    $V_{zz}=0$\n",
    "\n",
    "<br>\n",
    "\n",
    "3. PG\n",
    "\n",
    "    $\\frac{d}{dE_p}\\left(\\frac{dS_{mk}}{dE_n}\\right)^* = D_{nk}D_{kp}\\cdot\\left((E_k'+A_{mk}'')^*\\cdot e^{-i\\tau_m\\omega_p}(e^{-i\\tau_0\\omega_p} + e^{i\\phi_p}) + E_k^*\\cdot e^{i\\tau_m\\omega_n}(e^{-i\\tau_0\\omega_n} + e^{i\\phi_n})^*e^{-i\\tau_m\\omega_p}(e^{-i\\tau_0\\omega_p} + e^{i\\phi_p})\\right)$\n",
    "\n",
    "    $\\frac{d}{dE_p^*}\\left(\\frac{dS_{mk}}{dE_n^*}\\right)^* = D_{pk}D_{kn}\\cdot\\left((E_k'+A_{mk}'')^*\\cdot e^{-i\\tau_m\\omega_n}(e^{-i\\tau_0\\omega_n} + e^{i\\phi_n}) + E_k^*\\cdot e^{-i\\tau_m\\omega_n}(e^{-i\\tau_0\\omega_n} + e^{i\\phi_n}) e^{i\\tau_m\\omega_p}(e^{-i\\tau_0\\omega_p} + e^{i\\phi_p})^*\\right)$\n",
    "\n",
    "<br>\n",
    "\n",
    "4. SD\n",
    "\n",
    "    $\\frac{d}{dE_p}\\left(\\frac{dS_{mk}}{dE_n}\\right)^* = D_{nk}D_{kp}\\cdot 2(E_k'+A_{mk}'')e^{i\\tau_m\\omega_p}(e^{-i\\tau_0\\omega_p} + e^{i\\phi_p})^*$\n",
    "\n",
    "    $\\frac{d}{dE_p^*}\\left(\\frac{dS_{mk}}{dE_n^*}\\right)^* = D_{pk}D_{kn}\\cdot 2(E_k'+A_{mk}'')e^{-i\\tau_m\\omega_n}(e^{-i\\tau_0\\omega_n} + e^{i\\phi_n})$\n",
    "\n",
    "\n",
    "\n",
    "<br>\n",
    "\n",
    "5. nth-HG  \n",
    "    \n",
    "    $V_{zz} = 0$"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a738b1ee",
   "metadata": {},
   "source": [
    "## Cross-Correlation"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "60a0a774",
   "metadata": {},
   "source": [
    "### Z-Gradient (with respect to pulse)  \n",
    "\n",
    "Same for all nonlinear methods\n",
    "\n",
    "$\\frac{dS_{mk}}{dE_n^*} = 0$  \n",
    "\n",
    "$\\frac{dS_{mk}}{dE_n} = D_{kn}G_{mk}$"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6f368210",
   "metadata": {},
   "source": [
    "### Z-Gradient (with respect to gate-pulse)  \n",
    "\n",
    "1. SHG  \n",
    "\n",
    "    $\\frac{dS_{mk}}{dA_n^*} = 0$  \n",
    "\n",
    "    $\\frac{dS_{mk}}{dA_n} = D_{kn}E_k e^{-i\\tau_m\\omega_n}(e^{-i\\tau_0\\omega_n}+e^{i\\phi_n})$\n",
    "\n",
    "<br>\n",
    "\n",
    "2. THG  \n",
    "\n",
    "    $\\frac{dS_{mk}}{dA_n^*} = 0$  \n",
    "\n",
    "    $\\frac{dS_{mk}}{dA_n} = 2 D_{kn}E_k (A_{mk}+A_{mk}')\\cdot e^{-i\\tau_m\\omega_n}(e^{-i\\tau_0\\omega_n}+e^{i\\phi_n})$\n",
    "\n",
    "<br>\n",
    "\n",
    "3. PG  \n",
    "\n",
    "    $\\frac{dS_{mk}}{dA_n^*} = D_{nk}E_k(A_{mk}+A_{mk}')\\cdot e^{i\\tau_m\\omega_n}(e^{i\\tau_0\\omega_n}+e^{-i\\phi_n})$\n",
    "\n",
    "    $\\frac{dS_{mk}}{dA_n} = D_{kn}E_k(A_{mk}+A_{mk}')^*\\cdot e^{-i\\tau_m\\omega_n}(e^{-i\\tau_0\\omega_n}+e^{i\\phi_n})$\n",
    "\n",
    "<br>\n",
    "\n",
    "4. SD  \n",
    "\n",
    "    $\\frac{dS_{mk}}{dA_n^*} = 2 D_{nk}E_k (A_{mk}+A_{mk}')^*\\cdot e^{i\\tau_m\\omega_n}(e^{i\\tau_0\\omega_n}+e^{-i\\phi_n})$\n",
    "\n",
    "    $\\frac{dS_{mk}}{dA_n} = 0$\n",
    "\n",
    "<br>\n",
    "\n",
    "5. nth-HG  \n",
    "\n",
    "    $\\frac{dS_{mk}}{dE_n^*} = 0$  \n",
    "\n",
    "    $\\frac{dS_{mk}}{dE_n} = (n-1) D_{kn}E_k (A_{mk}+A_{mk}')^{n-2}\\cdot e^{-i\\tau_m\\omega_n}(e^{-i\\tau_0\\omega_n}+e^{i\\phi_n})$"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "54e2d5c3",
   "metadata": {},
   "source": [
    "### Z-Pseudo-Hessian (with respect to pulse)  \n",
    "\n",
    "Same for all nonlinear methods\n",
    "\n",
    "$V_{zz} = 0$"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "12400aaa",
   "metadata": {},
   "source": [
    "### Z-Pseudo-Hessian (with respect to gate-pulse)  \n",
    "\n",
    "1. SHG  \n",
    "\n",
    "    $V_{zz}=0$\n",
    "    \n",
    "<br>\n",
    "\n",
    "2. THG  \n",
    "\n",
    "    $V_{zz}=0$\n",
    "\n",
    "<br>\n",
    "\n",
    "3. PG\n",
    "\n",
    "    $\\frac{d}{dA_p}\\left(\\frac{dS_{mk}}{dA_n}\\right)^* = D_{nk}D_{kp}\\cdot e^{i\\tau_m\\omega_n}(e^{-i\\tau_0\\omega_n} + e^{i\\phi_n})^* e^{-i\\tau_m\\omega_p}(e^{-i\\tau_0\\omega_p} + e^{i\\phi_p})\\cdot E_k^*$\n",
    "\n",
    "    $\\frac{d}{dA_p^*}\\left(\\frac{dS_{mk}}{dA_n^*}\\right)^* = D_{kn}D_{pk}\\cdot e^{-i\\tau_m\\omega_n}(e^{-i\\tau_0\\omega_n} + e^{i\\phi_n})e^{i\\tau_m\\omega_p}(e^{-i\\tau_0\\omega_p} + e^{i\\phi_p})^*\\cdot E_k^*$\n",
    "\n",
    "<br>\n",
    "\n",
    "4. SD\n",
    "\n",
    "    $V_{zz}=0$\n",
    "\n",
    "\n",
    "<br>\n",
    "\n",
    "5. nth-HG  \n",
    "    \n",
    "    $V_{zz} = 0$"
   ]
  }
 ],
 "metadata": {
  "language_info": {
   "name": "python"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
